<!-- Horários de funcionamento -->
<div class="container mt-4 p-4 bg-white rounded border">
  <h2 class="text-center mb-4">ESTAMOS ABERTOS</h2>
  <div class="row justify-content-center">
    <div class="col-md-6">
      <table class="table text-center">
        <tbody>
          <tr><td>Domingo</td><td>19:00 às 22:00</td></tr>
          <tr><td>Segunda</td><td>Fechado</td></tr>
          <tr><td>Terça</td><td>19:00 às 22:00</td></tr>
          <tr><td>Quarta</td><td>19:00 às 22:00</td></tr>
          <tr><td>Quinta</td><td>19:00 às 22:00</td></tr>
          <tr><td>Sexta</td><td>19:00 às 22:00</td></tr>
          <tr><td>Sábado</td><td>19:00 às 22:00</td></tr>
        </tbody>
      </table>

      <div class="text-center mt-4">
        <i class="bi bi-telephone"></i> (83) 3585-8468
      </div>
    </div>
  </div>
</div>

<!-- Mapa -->
<div class="container mb-4 mt-4 p-4 bg-white rounded border text-center">
  <p><i class="bi bi-geo-alt-fill"></i> Avenida Sapé - Manaíra, João Pessoa - PB</p>
  <iframe
    src="https://www.google.com/maps?q=Av.+Sapé,+Manaíra,+João+Pessoa,+PB&output=embed"
    width="100%"
    height="300"
    style="border:0;"
    allowfullscreen=""
    loading="lazy"
  ></iframe>
</div>

<!-- Início do formulário -->
<div class="container my-5">
  <div class="bg-white p-4 rounded shadow-sm">
    <h2 class="text-center mb-4">FAÇA SUA RESERVA</h2>
    <form [formGroup]="reservaForm" (ngSubmit)="handleSubmit()">

      <!-- Campo Nome -->
      <div class="mb-3">
        <input type="text" class="form-control" placeholder="Digite seu nome" formControlName="nome" />
        @if(reservaForm.get('nome')?.touched && reservaForm.get('nome')?.invalid) {
          <span class="text-danger">* Nome obrigatório (mínimo 3 caracteres)</span>
        }
      </div>

      <!-- Campo Telefone -->
      <div class="mb-3">
        <input type="text" class="form-control" placeholder="(83) 999999999" formControlName="telefone" />
        @if(reservaForm.get('telefone')?.touched && reservaForm.get('telefone')?.invalid) {
          <span class="text-danger">* Telefone inválido. Formato esperado: (83) 999999999</span>
        }
      </div>

      <!-- Campo de Data com calendário -->
      <div class="mb-3">
        <label class="form-label">Selecione a data da reserva:</label>
        <input type="date" class="form-control" formControlName="data" />
        @if(reservaForm.get('data')?.touched && reservaForm.get('data')?.invalid) {
          <span class="text-danger">* Data obrigatória.</span>
        }
      </div>


      <!-- Horário -->
      <div class="mb-3">
        <select class="form-control" formControlName="horario">
          <option value="">Horário</option>
          <option *ngFor="let h of ['19:00', '19:30', '20:00', '20:30', '21:00', '21:30']">{{ h }}</option>
        </select>
      </div>

      <!-- Número de Pessoas -->
      <div class="mb-4">
        <select class="form-control" formControlName="pessoas">
          <option value="">Nº de pessoas</option>
          <option *ngFor="let p of [1,2,3,4,5,6]" [value]="p">{{ p }}</option>
        </select>
      </div>

      <!-- Botão -->
      <div class="text-center">
        <button class="btn btn-danger" type="submit" [disabled]="reservaForm.invalid">
          Finalizar reserva
        </button>
      </div>

    </form>
  @if(success()) {
    <div class="alert alert-success text-center mt-3">
      Reserva enviada com sucesso!
    </div>
  }
  <!--Cards de Reservas-->
  <hr class="my-5">
  <h3 class="text-center mb-4">Reservas Cadastradas</h3>

  <!--NgIf is deprecated. Use the @if block instead. Intent to remove in v22-->
  <div *ngIf="reservas().length === 0" class="text-center text-muted">
    Nenhuma reserva encontrada.
  </div>

  <div class="d-flex flex-wrap justify-content-center gap-3">
    <div
      class="card border border-danger shadow-sm"
      style="width: 20rem;"
      *ngFor="let r of reservas()"
    >
      <div class="card-body">
        <h5 class="card-title">{{ r.nome }}</h5>
        <h6 class="card-subtitle mb-2 text-muted">{{ r.telefone }}</h6>
        <p class="card-text">
          <strong>Data:</strong> {{ r.data }}<br>
          <strong>Horário:</strong> {{ r.horario }}<br>
          <strong>Pessoas:</strong> {{ r.pessoas }}
        </p>
        <button class="btn btn-outline-danger btn-sm w-100" (click)="cancelarReserva(r.id)">
          Cancelar reserva
        </button>
      </div>
    </div>
  </div>
</div>

